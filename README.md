# jwp-subway-path

## 요구사항

### Step 1. 구간(section) 관리기능

- 지하철 구간(section)
	- 상행역과 하행역 사이의 연결 정보.
	- 길이(distance) 속성을 가짐.
- [x] 구간 등록 기능
	- `POST` /lines/{id}/sections
	  ```json
	  {
		"downStationId" : "4",
		"upStationId" : "2",
		"distance" : 10
	  }
	  ```
	- 지하철 노선에 구간 등록
	- 새로운 구간의 상행역은 해당 노선에 등록되어있는 하행 종점역이어야 한다.
		- 하행 방향으로만 새로운 역 추가가 가능하다.
	- 새로운 구간의 하행역은 해당 노선에 등록되어있는 역일 수 없다.
	- 위 조건에 부합하지 않는 경우 에러 처리한다.
- [x] 구간 제거 기능
	- `DELETE` /lines/{id}/sections?stationId={station_id}
	- 하행 종점역만 제거할 수 있다.
	- 지하철 노선에 상행 종점역과 하행 종점역만 있는 경우 역을 삭제할 수 없다.
		- 구간이 1개인 경우 삭제할 수 없다.
	- 위 조건에 부합하지 않는 경우 에러 처리한다.
- [x] 기존 노선 생성 방식 변경
	- 리액트 프론트엔드 참고하여 노선 생성 시 반드시 구간을 함께 생성하도록 변경.
	- `POST` /lines
	  ```json
	  {
		"name": "2호선",
		"color": "green",
		"downStationId": 2,
		"upStationId": 3,
		"distance": 10
	  }
	  ```
	- 노선 생성 시 반드시 1개의 구간을 포함하여 생성하도록 한다.

### Step 2. 구간 추가 기능 심화

- [x] 역 사이에 새로운 역을 등록
	- [x] 노선에 새로운 구간의 두 역 중 하나도 없으면 오류
	- [x] 노선에 새로운 구간의 두 역이 모두 있으면 오류
	- 노선에 상행역이 이미 있다면
		- [x] 상행역이 기존 노선의 하행 종점역인 경우에는 별도 검증 없이 추가 가능
		- [x] 상행역이 하행 종점역이 아닌 경우 원래 구간과 거리 비교
	- 노선에 하행역이 이미 있다면
		- [x] 하행역이 기존 노선의 상행 종점역인 경우 별도 검증 없이 추가 가능
		- [x] 하행역이 상행 종점역이 아닌 경우 원래 구간과 거리 비교
- [x] LineRequest에서 정렬된 stations를 반환

### Step 3. 구간 제거 기능 심화

- [x] 마지막 역 외에도 삭제할 수 있도록 변경
	- [x] 구간이 하나인 노선에서 역 제거하면 오류
	- [x] 노선에 없는 역 제거하면 오류
	- [x] 종점이 제거될 경우 연결된 다음 역이 종점이 됨
	- [x] 중간역이 제거될 경우 앞 뒤 역을 이어주며 재배치, 거리는 두 구간의 합으로 함
- [x] 역 삭제
    ```
    DELETE /stations/{id}
    ```
	- [x] 이미 역이 포함된 구간이 존재하면 삭제 오류
- [x] 노선 삭제 시 연관된 구간 모두 삭제

### Step 4. 경로 조회 기능

- [ ] 역 간 최단 경로를 조회하는 기능 추가
	- request
	  ```shell
	  GET /paths?source={source_station_id}&target={target_station_id}
	  ```
	- example response
	    ```json
		{
			"stations": [
				{
					"id": 1,
					"name": "교대역"
				},
				{
					"id": 4,
					"name": "남부터미널역"
				},
				{
					"id": 3,
					"name": "양재역"
				}
			],
			"distance": 5
		}
		```
	- `jgrapht` 라이브러리 이용
	- [ ] 최단거리가 존재하는 경우 정상 응답
	- [ ] 최단거리가 존재하지 않는 경우 오류
	- [ ] 각 역 id가 `null`인 경우 오류
	- [ ] 존재하지 않는 역 id인 경우 오류
	- [ ] 역이 존재하지만 역이 포함된 구간이 존재하지 않는 경우 오류
- [ ] 데이터베이스 설정을 프로덕션과 테스트를 다르게 합니다

## 커밋 컨벤션

커밋 메시지는 아래 포맷에 맞게 설정한다.

```shell
	<commit_type> : <commit_message>
```

커밋 타입은 아래 항목 중 하나로 한다.

- feature
- test
- refactor
- docs
- fix
- chore